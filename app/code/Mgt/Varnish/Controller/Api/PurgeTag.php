<?php
 namespace Mgt\Varnish\Controller\Api; class PurgeTag extends \Magento\Framework\App\Action\Action { protected $cachePurger; protected $config; public function __construct(\Magento\Framework\App\Action\Context $context, \Magento\CacheInvalidate\Model\PurgeCache $cachePurger, \Mgt\Varnish\Model\Cache\Config $config) { goto C9d9f; aac97: $this->config = $config; goto c2e55; C9d9f: $this->cachePurger = $cachePurger; goto aac97; c2e55: parent::__construct($context); goto cc345; cc345: } public function execute() { goto F7411; f62fe: $response = $this->getResponse(); goto aa525; D30b2: $secretKey = $request->getParam("\163\145\143\x72\x65\164\113\145\171"); goto D1788; F7411: $request = $this->getRequest(); goto f62fe; E9c70: $response->setBody($body); goto cf4b0; aa525: $body = []; goto D30b2; C84b8: try { goto ccb29; cb6ac: $tags = [$tag]; goto Df532; f7417: throw new \Exception("\x53\x65\x63\x72\145\x74\40\141\160\x69\40\153\145\171\x20\x69\x73\x20\x6e\x6f\x74\x20\x63\x6f\x72\162\x65\x63\164"); goto Ac9df; Df532: $this->cachePurger->sendPurgeRequest($tags); goto A0049; Aa16f: if (!($secretKey != $apiSecretKey)) { goto A3eea; } goto f7417; ccb29: $apiSecretKey = $this->config->getApiSecretKey(); goto Aa16f; Ac9df: A3eea: goto cb6ac; A0049: $body = ["\x73\x75\143\x63\145\x73\163" => 1, "\x6d\x65\163\163\141\147\x65" => sprintf("\126\x61\x72\156\151\x73\x68\40\103\x61\143\150\x65\40\160\165\x72\147\145\144\x20\x62\x79\x20\146\157\x6c\154\x6f\x77\151\x6e\147\40\164\141\x67\x3a\x20\x25\x73", $tag)]; goto b8cf2; b8cf2: } catch (\Exception $e) { $errorMessage = $e->getMessage(); $body = ["\x73\165\x63\x63\145\163\x73" => 0, "\155\145\x73\163\x61\x67\145" => $errorMessage]; } goto A2a96; D1788: $tag = $request->getParam("\164\x61\x67"); goto B3fc6; ee3ea: exit; goto C98fd; C077e: $body = json_encode($body); goto bec69; bec69: $response->setHeader("\103\x6f\x6e\x74\x65\x6e\x74\x2d\124\x79\160\x65", "\x61\160\160\x6c\x69\143\x61\x74\x69\x6f\156\x2f\x6a\x73\x6f\x6e"); goto E9c70; A2a96: f0b2c: goto C077e; B3fc6: if (!($secretKey && $tag)) { goto f0b2c; } goto C84b8; cf4b0: $response->sendResponse(); goto ee3ea; C98fd: } }
