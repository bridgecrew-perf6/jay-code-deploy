<?php
 namespace Mgt\Varnish\Controller\Adminhtml\Queue; class Information extends \Magento\Backend\App\Action { const SQL_LIMIT_URL_QUEUE = 500; protected $jsonHelper; protected $storeManager; protected $urlQueueCollection; public function __construct(\Magento\Backend\App\Action\Context $context, \Magento\Framework\Json\Helper\Data $jsonHelper, \Magento\Store\Model\StoreManagerInterface $storeManager, \Mgt\Varnish\Model\ResourceModel\UrlQueue\Collection $urlQueueCollection) { goto F3d98; F3d98: parent::__construct($context); goto cba25; a516f: $this->storeManager = $storeManager; goto Cfb59; Eb38d: $this->urlQueueCollection = $urlQueueCollection; goto a516f; cba25: $this->jsonHelper = $jsonHelper; goto Eb38d; Cfb59: } public function execute() { goto af558; c909a: $response = $this->getResponse(); goto D4df0; D4df0: $response->representJson($this->jsonHelper->jsonEncode($data)); goto feb79; Dd774: $urlsInQueue = $this->getUrlsFromQueue(); goto Fc144; feb79: return $response; goto A7ee5; af558: $numberOfUrls = $this->urlQueueCollection->getSize(); goto Dd774; Fc144: $data = ["\x6e\x75\x6d\x62\145\162\117\x66\125\x72\x6c\x73" => $numberOfUrls, "\x63\157\156\164\x65\156\164" => implode("\74\x62\x72\76", $urlsInQueue)]; goto c909a; A7ee5: } public function getUrlsFromQueue() { goto ad711; Cdca7: return $urls; goto ceb2b; Cf709: $this->urlQueueCollection->load(); goto ed8aa; d0448: $this->urlQueueCollection->setPageSize(self::SQL_LIMIT_URL_QUEUE); goto Cf709; ed8aa: foreach ($this->urlQueueCollection as $url) { goto a217f; C3e86: $url = sprintf("\x25\163\57\45\163", rtrim($store->getBaseUrl(), "\57"), ltrim($url->getPath(), "\57")); goto B1d6f; Cec42: $store = $this->storeManager->getStore($storeId); goto C3e86; b2230: fb004: goto eb1de; a217f: $storeId = $url->getStoreId(); goto Cec42; B1d6f: $urls[] = $url; goto b2230; eb1de: } goto c4eef; f30a8: $this->urlQueueCollection->addOrder("\x70\x72\151\x6f\x72\x69\x74\171"); goto d0448; c4eef: ed89f: goto Cdca7; ad711: $urls = []; goto f30a8; ceb2b: } }
