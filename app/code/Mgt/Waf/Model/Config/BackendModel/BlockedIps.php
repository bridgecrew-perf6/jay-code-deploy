<?php
 namespace Mgt\Waf\Model\Config\BackendModel; use Mgt\Waf\Model\Config\BackendModel\Value as ConfigValue; use Mgt\Waf\Model\Aws\Waf as AwsWaf; class BlockedIps extends ConfigValue { protected function _afterLoad() { goto e7b74; C3fbf: $value = ''; goto f6000; b5a0c: foreach ($blockedIpsIPv4 as $ip) { goto b60f5; fd2c7: e31bf: goto A0a49; A0a49: b1517: goto aeaf9; E6b13: $blockedIps[] = substr($ip, 0, -3); goto fd2c7; b60f5: if (!(substr($ip, -3) == "\57\63\62")) { goto e31bf; } goto E6b13; aeaf9: } goto ce26e; E2cd0: $awsRegion = $this->getAwsRegion(); goto d483c; F3e95: a226e: goto fe73d; d483c: $blockedIps = []; goto D9893; fe73d: $value = $sessionConfigData["\x67\x72\157\165\160\163"]["\x62\154\x6f\x63\x6b\145\x64\x5f\151\160\x73"]["\146\151\145\154\x64\163"]["\x62\x6c\x6f\x63\x6b\145\144\137\151\x70\x73"]["\166\141\154\x75\x65"]; goto f787b; B9f02: if (!(false === empty($blockedIpsIPv4))) { goto B581b; } goto b5a0c; ed26f: $blockedIpsIPv4 = $awsWaf->getIpAddressesForIpSet(AwsWaf::IP_SET_BLOCKED_IPS_IPV4); goto B9f02; f6000: if (true === isset($sessionConfigData["\147\162\157\165\160\163"]["\x62\x6c\x6f\x63\153\145\x64\x5f\151\x70\163"]["\146\x69\145\x6c\144\x73"]["\142\154\157\x63\153\x65\x64\x5f\x69\160\x73"]["\166\141\154\165\145"])) { goto a226e; } goto fb044; f787b: De091: goto C1d11; F172b: $projectName = $this->getProjectName(); goto B5bf0; B5bf0: if (!(false === empty($awsAccessKey) && false === empty($projectName))) { goto Dcaca; } goto F2dfb; D9893: $awsWaf = new AwsWaf($awsAccessKey, $awsSecretAccessKey, $awsRegion, $projectName); goto ed26f; Ae562: $value = implode(PHP_EOL, $blockedIps); goto C0f20; C1d11: $this->setValue($value); goto D657a; C6b90: feac8: goto Ae562; fb044: $awsAccessKey = $this->getAwsAccessKey(); goto F172b; b738d: Efc8e: goto C6b90; febf1: goto De091; goto F3e95; ac069: foreach ($blockedIpsIPv6 as $ip) { goto F77e8; a7d44: $blockedIps[] = substr($ip, 0, -4); goto Eb3a5; F77e8: if (!(substr($ip, -4) == "\57\x31\x32\x38")) { goto Fcf19; } goto a7d44; Eb3a5: Fcf19: goto f234c; f234c: F68bf: goto E6b03; E6b03: } goto b738d; e7b74: $sessionConfigData = $this->getSessionConfigData(); goto C3fbf; F2dfb: $awsSecretAccessKey = $this->getAwsSecretAccessKey(); goto E2cd0; E1e70: B581b: goto B04f0; d9ba2: if (!(false === empty($blockedIpsIPv6))) { goto feac8; } goto ac069; B04f0: $blockedIpsIPv6 = $awsWaf->getIpAddressesForIpSet(AwsWaf::IP_SET_BLOCKED_IPS_IPV6); goto d9ba2; ce26e: F53d6: goto E1e70; C0f20: Dcaca: goto febf1; D657a: } }
