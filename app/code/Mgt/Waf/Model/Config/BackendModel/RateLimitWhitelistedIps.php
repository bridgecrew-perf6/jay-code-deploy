<?php
 namespace Mgt\Waf\Model\Config\BackendModel; use Mgt\Waf\Model\Config\BackendModel\Value as ConfigValue; use Mgt\Waf\Model\Aws\Waf as AwsWaf; class RateLimitWhitelistedIps extends ConfigValue { protected function _afterLoad() { goto f0d82; f2de5: $awsWaf = new AwsWaf($awsAccessKey, $awsSecretAccessKey, $awsRegion, $projectName); goto Fd9c4; c16a5: if (!(false === empty($rateLimitWhitelistedIpv6))) { goto B1827; } goto e9b05; f0983: goto b4831; goto b54ce; e9b05: foreach ($rateLimitWhitelistedIpv6 as $ip) { goto db15d; Eb276: $whitelistedIps[] = substr($ip, 0, -4); goto bd855; bd855: c8017: goto cf6c9; cf6c9: e30fd: goto be2ef; db15d: if (!(substr($ip, -4) == "\57\61\x32\70")) { goto c8017; } goto Eb276; be2ef: } goto f1b18; b0d8d: $this->setValue($value); goto D817f; Bdcf0: $whitelistedIps = []; goto f2de5; A390c: b4831: goto b0d8d; A7109: $awsSecretAccessKey = $this->getAwsSecretAccessKey(); goto a041e; F4208: D8a6f: goto E8bcb; f0d82: $sessionConfigData = $this->getSessionConfigData(); goto ff31d; b54ce: C0240: goto C8233; a041e: $awsRegion = $this->getAwsRegion(); goto Bdcf0; F5d82: foreach ($rateLimitWhitelistedIpv4 as $ip) { goto c94c0; A9fab: c95a6: goto b02f7; Ef8b9: $whitelistedIps[] = substr($ip, 0, -3); goto A9fab; b02f7: A27f5: goto c08cb; c94c0: if (!(substr($ip, -3) == "\57\63\x32")) { goto c95a6; } goto Ef8b9; c08cb: } goto a7a86; E8bcb: $rateLimitWhitelistedIpv6 = $awsWaf->getIpAddressesForIpSet(AwsWaf::IP_SET_RATE_LIMIT_WHITELISTED_IPV6); goto c16a5; e9593: $awsAccessKey = $this->getAwsAccessKey(); goto De418; C8233: $value = $sessionConfigData["\x67\x72\157\165\x70\163"]["\x72\141\x74\145\x5f\x6c\151\x6d\x69\x74"]["\146\x69\x65\154\x64\163"]["\167\x68\151\x74\x65\154\151\163\164\145\144\137\x69\160\x73"]["\x76\141\154\x75\145"]; goto A390c; Fd9c4: $rateLimitWhitelistedIpv4 = $awsWaf->getIpAddressesForIpSet(AwsWaf::IP_SET_RATE_LIMIT_WHITELISTED_IPV4); goto A8a15; B59e9: if (!(false === empty($awsAccessKey) && false === empty($projectName))) { goto Daa0b; } goto A7109; a7a86: Cba33: goto F4208; C3a58: $value = implode(PHP_EOL, $whitelistedIps); goto a07fb; bba80: B1827: goto C3a58; C2366: if (true === isset($sessionConfigData["\147\162\x6f\165\160\163"]["\x72\141\164\145\x5f\x6c\x69\x6d\x69\x74"]["\146\x69\145\x6c\x64\163"]["\x77\x68\x69\164\145\x6c\151\x73\164\145\x64\137\151\160\163"]["\166\x61\x6c\165\x65"])) { goto C0240; } goto e9593; De418: $projectName = $this->getProjectName(); goto B59e9; a07fb: Daa0b: goto f0983; A8a15: if (!(false === empty($rateLimitWhitelistedIpv4))) { goto D8a6f; } goto F5d82; f1b18: b3873: goto bba80; ff31d: $value = ''; goto C2366; D817f: } }
